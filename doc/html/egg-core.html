<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<!-- $Id: egg-core.html,v 1.6 2001/01/22 23:47:32 guppy Exp $ -->

<html>
  <head>
    <title>Eggdrop Documentation: Eggdrop core</title>
  </head>

  <body>
    <div align="center">
      <p><strong>Eggdrop core</strong></p>
    </div>
    <hr>

    <p>This is an exhaustive list of all the Tcl commands added by eggdrop.
    All of the normal Tcl built-in commands are still there, of course. But
    you can also use these to manipulate features of the bot. Please see the
    module files for TCL commands relating to each module.</p>

    <p><strong>NOTICE:</strong> This list is accurate for the v1.6 series of
    eggdrop!</p>

    <p><strong>Scripts which were written for earlier versions will probably
    not work without modification. Some, however can be made to work using
    the compat.tcl distributed with eggdrop.</strong></p>
    <hr>

    <p><strong>Contents</strong></p>

    <blockquote>
      <ol>
        <li>
          <a href="#sect1">Configuration settings</a>

          <ol type="a">
            <li><a href="#sect1a">Executable path</a></li>

            <li><a href="#sect1b">Basic settings</a></li>

            <li><a href="#sect1c">Log files</a></li>

            <li><a href="#sect1d">Files and directories</a></li>

            <li><a href="#sect1e">Botnet, dcc and network</a></li>

            <li><a href="#sect1f">Console</a></li>

            <li><a href="#sect1g">Common stuff</a></li>

            <li><a href="#sect1h">Modules</a></li>

            <li><a href="#sect1i">Scripts</a></li>
          </ol>
        </li>

        <li><a href="#sect2">Output commands</a></li>

        <li><a href="#sect3">User record manipulation Commands</a></li>

        <li><a href="#sect4">DCC commands</a></li>

        <li><a href="#sect5">Miscellaneous commands</a></li>

        <li><a href="#sect6">Global variables</a></li>

        <li><a href="#sect7">Command extension</a></li>

        <li><a href="#sect8">Return values</a></li>

        <li><a href="#sect9">Matching characters</a></li>
      </ol>
    </blockquote>
    <hr>

    <p><a name="sect1"></a>1. <strong>Configuration settings</strong></p>

    <blockquote>
      <p>Lines in <strong>bold</strong> are the lines that need to be
      included in the eggdrop config file if you want to use the share
      module.<br>
       Lines in bold <strong><em>italics</em></strong> are optional and only
      required if you wish to change the default behaviour for that
      particular feature.</p>
    </blockquote>

    <p><a name="sect1a"></a>1a. <strong>Executable path</strong></p>

    <blockquote>
      <p>The first line in eggdrop configuration file should contain a full
      qualified path to eggdrop executable. It has to be implemented in the
      way the example shows to make the config file work as a shell
      script</p>

      <p>Example:</p>

      <p>#! /path/to/eggdrop</p>
    </blockquote>

    <p><a name="sect1b"></a>1b. <strong>Basic settings</strong></p>

    <blockquote>
      <p>You can change the basic eggdrop appearence and behaviour in this
      section.</p>
    </blockquote>

    <blockquote>
      <dl>
        <dt><strong><em>set username &quot;lamest&quot;</em></strong></dt>

        <dd>
          <p>This setting defines the username the bot uses.</p>

          <p>Note that this setting works only if no ident daemon is running
          on the machine your bot is on.</p>
        </dd>

        <dt><strong>set admin &quot;Lamer &lt;email:
        lamer@lamest.lame.org&gt;&quot;</strong></dt>

        <dd>
          <p>This setting defines which contact person should be shown in
          .status, /msg help and other places. You really should include this
          info.</p>
        </dd>

        <dt><strong><em>set network
        &quot;SomeIrcNetwork&quot;</em></strong></dt>

        <dd>
          <p>This setting is used only for info to share with others on your
          botnet.</p>
        </dd>

        <dt><strong>set timezone &quot;EST&quot;</strong></dt>

        <dd>
          <p>This setting defines the timezone is your bot in. It&#39;s used
          for internal routines as well as for logfile timestamping or
          scripting purposes. The timezone string specifies the name of the
          timezone and must be three or more alphabetic characters.</p>

          <p>ex. Central European Time(UTC+1) could be &quot;CET&quot;</p>
        </dd>

        <dt><strong><em>set offset &quot;5&quot;</em></strong></dt>

        <dd>
          <p>offset specifies the time value to be added to the local time to
          get Coordinated Universal Time (UTC aka GMT). The offset is
          positive if the local timezone is west of the Prime Meridian and
          negative if it is east. The value(hours) must be between 0 and
          24</p>

          <p>ex. if the timezone is UTC+1 the offset is -1</p>
        </dd>

        <dt><strong><em>set env(TZ) &quot;$timezone $offset&quot; (disabled
        by default)</em></strong></dt>

        <dd>
          <p>If you dont want to use the timezone setting for scripting
          purpose only but instead everywhere possible then use this
          setting.</p>
        </dd>

        <dt><strong><em>addlang &quot;english&quot;</em></strong></dt>

        <dd>
          <p>If you want to have your eggdrop messages displayed in another
          language change the below command to match your preferences. An
          alternative would be to set the environment variabel EGG_LANG to
          that value.</p>
        </dd>
      </dl>
    </blockquote>

    <p><a name="sect1c"></a>1c. <strong>Log files</strong></p>

    <p>Eggdrop is capable of logging various stuff, from channel chatter to
    commands people use on the bot or file transfers.</p>

    <p>Logfiles are kept normaly for 24 hours. Afterwards they&#39;ll be
    renamed to &quot;(logfilename).yesterday&quot;. After 48 hours
    they&#39;ll get overwritten by the logfile of the next day.</p>

    <blockquote>
      <dl>
        <dt><strong>set max-logs 5</strong></dt>

        <dd>
          <p>maximum number of logfiles to allow - this can be increased if
          needed</p>

          <p><strong>(don&#39;t decrease this)</strong></p>
        </dd>

        <dt><strong><em>set max-logsize 0</em></strong></dt>

        <dd>
          <p>maximum size of your logfiles, set this to 0 to disable. This
          value is in KiloBytes, so &#39;550&#39; would mean cycle logs when
          it reaches the size of 550 KiloBytes.</p>

          <p>Note that this only works if you have keep-all-logs 0</p>
        </dd>

        <dt><strong><em>set quick-logs 0</em></strong></dt>

        <dd>
          <p>Defaultly eggdrop writes every 5 minutes its logfiles to disk.
          You can change this behaviour by turning this setting to 1. Eggdrop
          will write and check the logfiles for size every minute.</p>

          <p>Note that this setting might increase the cpu usage of your bot
          (on the other hand it will decrease your mem usage)</p>
        </dd>

        <dt><strong>logfile &lt;logflags&gt; &lt;channel&gt;
        &quot;logs/logfile&quot;</strong></dt>

        <dd>
          <p>This setting actually tells the bot what should be loged from
          where in which file.</p>

          <p>The most common log file flags are:</p>

          <p>m private msgs/ctcps to the bot<br>
           k kicks, bans, mode changes on the channel<br>
           j joins, parts, netsplits on the channel<br>
           p public chatter on the channel<br>
           s server connects/disconnects/notices<br>
           b information about bot linking and userfile sharing<br>
           c commands people use (via msg or dcc)<br>
           x file transfers and file-area commands<br>
           r (if use-console-r enabled) EVERYTHING sent to the bot by the
          server<br>
           o other: misc info, errors -- IMPORTANT STUFF<br>
           w wallops: msgs between IRCops (be sure to set the bot +w in
          init-server)</p>

          <p>There are others, but you probably shouldnt log them, it&#39;d
          be rather unethical ;). There are also five user-defined levels
          (&#39;1&#39;..&#39;5&#39;) which are used by Tcl scripts.</p>

          <p>Each logfile belongs to a certain channel. Events of type
          &#39;k&#39;, &#39;j&#39;, and &#39;p&#39; are logged to whatever
          channel they happened on. Most other events are currently logged to
          every channel. You can make a logfile belong to all channels by
          assigning it to channel &quot;*&quot;.</p>

          <p>Examples:</p>

          <p><strong>logfile mco * &quot;logs/eggdrop.log&quot;<br>
           logfile jpk #lamest &quot;logs/lamest.log&quot;<br>
          </strong></p>

          <p>In &#39;eggdrop.log&#39; put private msgs/ctcps, commands, misc
          info, and errors from any channel<br>
           In &#39;lame.log&#39; put joins, parts, kicks, bans, public
          chatter and mode changes from #lamest</p>
        </dd>

        <dt><strong><em>set log-time 1</em></strong></dt>

        <dd>
          <p>Use this feature to timestamp entries in the log file.</p>

          <p>Valid settings are 0 and 1.</p>
        </dd>

        <dt><strong>set keep-all-logs 0</strong></dt>

        <dd>
          <p>If you want to keep your logfiles forever turn this setting on.
          All logfiles will get suffix &quot;.[day, 2 digits][month, 3
          letters][year, 4 digits]&quot; Note that your quota might get full
          by this, so check your logfiles often and download them.</p>

          <p>Valid settings are 0 and 1.</p>
        </dd>

        <dt><strong>set switch-logfiles-at 300</strong></dt>

        <dd>
          <p>You can specify in this setting, when eggdrop should switch the
          logfiles and started fresh.</p>

          <p>You have to use military time in here. 300 is default and
          describes 00:00.</p>

          <p>Note that a leading 0 will make Tcl think this is an octal
          value, something you probably don&#39;t want.</p>
        </dd>

        <dt><strong><em>set quiet-save 0</em></strong></dt>

        <dd>
          <p>Those nasty &quot;Writing user file...&quot; and &quot;Writing
          channel file ...&quot; messages wont be logged anymore if this
          option is enabled.</p>

          <p>Valid settings are 0 and 1.</p>
        </dd>
      </dl>
    </blockquote>

    <p><a name="sect1d"></a>1d. <strong>Files and directories</strong></p>

    <blockquote>
      <dl>
        <dt><strong>set userfile &quot;LamestBot.user&quot;</strong></dt>

        <dd>
          <p>Specify here how your userfile should be called</p>
        </dd>

        <dt><strong><em>set sort-users 0</em></strong></dt>

        <dd>
          <p>If you want your userfile to be sorted on save, turn this
          feature on.</p>

          <p>Note that this takes a bit more cpu</p>

          <p>Valid settings are 0 and 1.</p>
        </dd>

        <dt><strong>set help-path &quot;help/&quot;</strong></dt>

        <dd>
          <p>Specify here where eggdrop should look for help files. Don&#39;t
          modify this setting until you know what you&#39;re doing!</p>
        </dd>

        <dt><strong>set temp-path &quot;/tmp&quot;</strong></dt>

        <dd>
          <p>Set here a place to store temporarily files</p>
        </dd>

        <dt><strong>set motd &quot;text/motd&quot;</strong></dt>

        <dd>
          <p>The MOTD (motto of the day) is displayed when people dcc chat or
          telnet to the bot.</p>

          <p>Look into doc/settings.motd or type &#39;.help set motd&#39; in
          DCC CHAT or telnet connection for options.</p>
        </dd>

        <dt><strong>set telnet-banner &quot;text/banner&quot;</strong></dt>

        <dd>
          <p>This banner will be displayed on telnet connections</p>
        </dd>

        <dt><strong>set userfile-perm 0600</strong></dt>

        <dd>
          <p>Specifies what permissions the user, channel and notes (if notes
          module is loaded) files should be set to.</p>

          <p>The octal values are the same as for the chmod system
          command.</p>

          <p>To remind you:</p>
<pre>
           u  g  o           u  g  o           u  g  o
     0600  rw-------   0400  r--------   0200  -w-------    u - user
     0660  rw-rw----   0440  r--r-----   0220  -w--w----    g - group
     0666  rw-rw-rw-   0444  r--r--r--   0222  -w--w--w-    o - others
</pre>

          <p>Note that the default 0600 is the most secure one and should
          only be changed if you need your files for shell scripting or other
          external applications.</p>
        </dd>

        <dt><strong>set mod-path &quot;modules/&quot;</strong></dt>

        <dd>
          <p>This path specifies the path were eggdrop should look for its
          modules</p>
        </dd>
      </dl>
    </blockquote>

    <p><a name="sect1e"></a>1e. <strong>Botnet, dcc and network</strong></p>

    <p>Settings in this section should be unimportant fur you until you deal
    with botnets (multiple eggdrops conected together to maximize efficency).
    You should read doc/BOTNET before modifying these settings.</p>

    <blockquote>
      <dl>
        <dt><strong><em>set botnet-nick &quot;LlamaBot&quot;</em></strong>
        (disabled by default)</dt>

        <dd>
          <p>If you want to use a differnt nickname on the botnet than you
          use on IRC (i.e. if you&#39;re in an untrusted botnet) set it
          here.</p>
        </dd>

        <dt><strong>listen &lt;port&gt; &lt;mode&gt;</strong></dt>

        <dd>
          <p>The listen command opens a telnet port by which you or other
          bots can interact with the eggdrop by telneting in.</p>

          <p>Valid ports are (as long as you aren&#39;t root) &gt;1024.</p>

          <p>Valid modes are &#39;all&#39;, &#39;bots&#39; and
          &#39;users&#39;. You can assign special ports for users and bots,
          or one for all.</p>

          <p>Examples:</p>

          <p><strong>listen 3333 bots<br>
           listen 4444 users</strong></p>

          <p>or:</p>

          <p><strong>listen 3333 all</strong></p>

          <p>There are more options for the listen command in
          doc/tcl-commands.doc</p>

          <p>Note, if you are running more than one bot on the same machine,
          you will want to space the telnet ports at LEAST 5 apart... 10 is
          even better.</p>
        </dd>

        <dt><strong><em>set remote-boots 2</em></strong></dt>

        <dd>
          <p>This setting defines if people can boot users on the eggdrop
          from other bots in your botnet.</p>

          <p>Valid settings are:</p>

          <p>0 - allow *no* outside boots<br>
           1 - allow boots from sharebots<br>
           2 - allow any boots</p>
        </dd>

        <dt><strong><em>set share-unlinks 1</em></strong></dt>

        <dd>
          <p>This setting prohibits eggdrop to unlink from share bots if an
          remote bots tells so.</p>
        </dd>

        <dt><strong>set telnet-flood 5:60</strong></dt>

        <dd>
          <p>Define here how many telnet connection attempt in how many
          seconds from the same host constitute a flood.</p>

          <p>Attempts:Seconds</p>
        </dd>

        <dt><strong><em>set paranoid-telnet-flood 1</em></strong></dt>

        <dd>
          <p>If you telnet-flood to apply even to +f users, set this setting
          to 1</p>

          <p>Valid settings are 0 and 1.</p>
        </dd>

        <dt><strong>set open-telnets 0</strong></dt>

        <dd>
          <p>If you want people allow to telnet in and type &#39;NEW&#39; to
          become a new user, set this to 1. This is similar to
          &#39;hello&#39;</p>

          <p>Valid settings are 0 and 1.</p>
        </dd>

        <dt><strong>set protect-telnet 0</strong></dt>

        <dd>
          <p>This setting will drop telnet connections not matching a known
          host. It greatly improves protection from IRCOPs, but makes it
          impossible for NOIRC bots to add hosts or have NEW as a valid
          login.</p>

          <p>Valid settings are 0 and 1.</p>
        </dd>

        <dt><strong><em>set stealth-telnets 0</em></strong></dt>

        <dd>
          <p>If you don&#39;t want eggdrop to identify itself on a telnet
          connection, set this setting to 1. Eggdrop will display its
          nickname instead.</p>

          <p>Valid settings are 0 and 1.</p>
        </dd>

        <dt><strong><em>set use-telnet-banner 0</em></strong></dt>

        <dd>
          <p>If you want eggdrop to display a banner when telneting in set
          this setting to 1. The telnet banner is set by
          &#39;telnet-banner&#39;.</p>
        </dd>

        <dt><strong>set dcc-sanitycheck 1</strong></dt>

        <dd>
          <p>This setting will make the bot ignore DCC chat requests which
          appear to have bogus information on the grounds that the user may
          have been trying to make the bot connect to somewhere that will get
          it into trouble, or that the user has a broken client (like mIRC
          tends to do), in which case the connect wouldn&#39;t work anyway.
          It&#39;s suggested that you turn this on.</p>

          <p>Valid settings are 0 and 1.</p>
        </dd>

        <dt><strong><em>set quiet-reject 1</em></strong></dt>

        <dd>
          <p>If set to 1, the bot will squelch the error message when
          rejecting a DCC CHAT or SEND.</p>

          <p>Normally eggdrop tells the DCC user that the CHAT or SEND has
          been rejected because they don&#39;t have access, but sometimes IRC
          server operators detect bots that way.</p>
        </dd>

        <dt><strong>set max-dcc 50</strong></dt>

        <dd>
          <p>Set here the maximum number of dcc connections you will allow -
          you can increase this later, but never decrease it.</p>
        </dd>

        <dt><strong><em>set require-p 0</em></strong></dt>

        <dd>
          <p>Define here if +o user still need the +p flag to dcc the
          bot.</p>

          <p>Valid settings are 0 and 1.</p>
        </dd>

        <dt><strong>set dcc-flood-thr 3</strong></dt>

        <dd>
          <p>Specify here the number of lines from a user on the partyline
          (dcc, telnet) before they are considered to be flooding (and
          therefore get booted)</p>
        </dd>

        <dt><strong>set resolve-timeout 15</strong></dt>

        <dd>
          <p>Set here the amount of seconds before giving up on
          hostname/address lookup. (you might want to increase this if you
          are on a slow network).</p>
        </dd>

        <dt><strong>set ident-timeout 5</strong></dt>

        <dd>
          <p>Set a timeout in seconds how long to wait on ident-lookups.</p>
        </dd>

        <dt><strong>set connect-timeout 15</strong></dt>

        <dd>
          <p>This settings defines a timeout in seconds how long the bot
          should wait for a dcc chat, telnet, relay, etc connection.</p>
        </dd>

        <dt><strong><em>set my-hostname
        &quot;virtual.host.com&quot;</em></strong></dt>

        <dt><strong><em>set my-ip &quot;99.99.0.0&quot;</em></strong></dt>

        <dd>
          <p>If you&#39;re using virtual hosting (your machine has more than
          1 IP), you may want to specify the particular IP to bind to. You
          can specify either by hostname or by IP. You may also want to set
          the hostname here if eggdrop has trouble detecting it when it
          starts up.</p>
        </dd>

        <dt><strong><em>set firewall &quot;host:port&quot;</em></strong></dt>

        <dd>
          <p>Set this to your socks host if your eggdrop sits behind a
          firewall</p>

          <p>Example:</p>

          <p><strong>set firewall &quot;proxy:178&quot;</strong></p>

          <p>If you use a Sun &quot;telnet passthru&quot; firewall, use this
          setting:</p>

          <p>Example:</p>

          <p><strong>set firewall
          &quot;!sun-barr.ebay:3666&quot;</strong></p>
        </dd>

        <dt><strong><em>set nat-ip &quot;127.0.0.1&quot;</em></strong></dt>

        <dd>
          <p>If you have a NAT firewall (you box has an IP in one of the
          following ranges: 192.168.0.0-192.168.255.255,
          172.16.0.0-172.31.255.255, 10.0.0.0-10.255.255.255 and your
          firewall transparently changes your address to a unique address for
          your box.) or you have IP masquerading between you and the rest of
          the world, and /dcc chat,/ctcp chat or userfile shareing aren&#39;t
          working. Enter your outside IP here.</p>

          <p>Do not enter anything for my-ip or my-hostname if you use this
          setting.</p>
        </dd>

        <dt><strong><em>set reserved-portrange 2010:2020</em></strong></dt>

        <dd>
          <p>If you want all your dcc file transfers bound to a particular portrange,
          either because your behind a firewall, or for other security reasons, set it
          here.</p>
        </dd>

        <dt><strong><em>set dcc-portrange 1024:65535</em></strong></dt>

        <dd>
          <p>This setting is so that people can&#39;t send fake ports to your
          bot when they try to dcc it. irc clients should never use a port
          below 1024 and well 65535 is the highest port possible. this
          setting is used for telnet too.</p>
        </dd>

        <dt><strong><em>set dupwait-timeout 5</em></strong></dt>

        <dd>
          <p>If your eggdrop rejects bots that actually have already
          disconnected from another hub, but the disconnect information has
          not yet spread over the botnet due to lag, use this setting.</p>

          <p>The bot will wait dupwait-timeout seconds before it checks again
          and then finally reject the bot.</p>
        </dd>
      </dl>
    </blockquote>

    <p><a name="sect1f"></a>1f. <strong>Console</strong></p>

    <blockquote>
      <dl>
        <dt><strong>set console &quot;mkcobxs&quot;</strong></dt>

        <dd>
          <p>This is the default console mode. It uses the same event flags
          as the log files do.</p>

          <p>Note that the console channel is automatically set to your
          &quot;primary&quot; channel (the one you defined first in config
          file)</p>

          <p>Masters can change their console channel and modes with the
          &#39;.console&#39; command</p>
        </dd>
      </dl>
    </blockquote>

    <p><a name="sect1g"></a>1g. <strong>Common stuff</strong></p>

    <blockquote>
      <dl>
        <dt><strong>set ignore-time 15</strong></dt>

        <dd>
          <p>Set the time in minutes how long temporary ignores should
          last</p>
        </dd>

        <dt><strong>set hourly-updates 00</strong></dt>

        <dd>
          <p>Define here what eggdrop calls &#39;hourly&#39;. All calls to
          it, including such things as note notifying or userfile saving are
          affected by this.</p>

          <p>Example:</p>

          <p><strong>set hourly-updates 15</strong></p>

          <p>Bot will save 15 minutes past every hour its userfile</p>
        </dd>

        <dt><strong>set owner &quot;MrLame, MrsLame&quot;</strong></dt>

        <dd>
          <p>Put all permanent owner into this variable.</p>
        </dd>

        <dt><strong>set default-flags &quot;hp&quot;</strong></dt>

        <dd>
          <p>Enter all flags that new users should get as a default.</p>
        </dd>

        <dt><strong><em>set whois-fields &quot;url
        birthday&quot;</em></strong></dt>

        <dd>
          <p>Enter all user-defined fields that should be displayed in a
          &#39;.whois&#39; This will only be shown if the user has one of
          these xtra fields.</p>

          <p>You might prefer to comment this out and use the userinfo1.0.tcl
          script which provides commands for changing all of these.</p>
        </dd>

        <dt><strong><em>set die-on-sighup 0</em></strong></dt>

        <dd>
          <p>Enable this setting if you want your eggdrop on receiving a
          SIGHUP. Otherwise eggdrop will just rehash.</p>

          <p>Valid settings are 0 and 1.</p>
        </dd>

        <dt><strong><em>set die-on-sigterm 0</em></strong></dt>

        <dd>
          <p>Enable this setting if you want your eggdrop on receiving a
          SIGTERM. Otherwise eggdrop will just save its userfile.</p>

          <p>Valid settings are 0 and 1.</p>
        </dd>

        <dt><strong>set must-be-owner 0</strong></dt>

        <dd>
          <p>If you enable this setting, only permanent owners (owner
          setting) will be able to use .tcl and .set moreover if you want
          only let permanent owners use .dump, then set it to 2 Valid
          settings are 0, 1 and 2</p>
        </dd>

        <dt><strong><em>set enable-simul 1</em></strong></dt>

        <dd>
          <p>Enable this setting, if you want to enable the
          &#39;dccsimul&#39; tcl command</p>

          <p>Valid settings are 0 and 1.</p>
        </dd>

        <dt><strong><em>set allow-dk-cmds 1</em></strong></dt>

        <dd>
          <p>Enable this setting, if you want +d &amp; +k users to use
          commands bound as -|-</p>

          <p>Valid settings are 0 and 1.</p>
        </dd>
      </dl>
    </blockquote>

    <p><a name="sect1h"></a>1h. <strong>Modules</strong></p>

    <blockquote>
      <p>After the core settings you should start loading any modules you
      need. Modules are loaded by the command &quot;loadmodule module&quot;.
      Eggdrop looks for modules in the directory you specified by the
      module-path setting in the path section.<br>
      </p>

      <p>Documentation and a list of all modules can be found in doc/modules
      directory</p>

      <p>Please note, that for different configurations different modules are
      needed.</p>
    </blockquote>

    <blockquote>
      <dl>
        <dt><strong>Channel security bot</strong></dt>

        <dd>
          <p>This bot needs channel, console, dns, irc and if you like ctcp
          module loaded. More is not needed and makes the bot slower.</p>
        </dd>

        <dt><strong>Public bot</strong></dt>

        <dd>
          <p>A public bot should have all modules available loaded since they
          provide all functions for everybody.</p>
        </dd>

        <dt><strong>Secure filesys bot</strong></dt>

        <dd>
          <p>This bot needs all normal irc operating modules but not notes,
          seen, ctcp or share module.</p>
        </dd>

        <dt><strong>Limbo bot</strong></dt>

        <dd>
          <p>A limbo bot (bot serves as a botnet hub outside irc) just needs
          channels, console, dns and maybe notes or share module loaded. Of
          course blowfish needs to be loaded here, too.</p>
        </dd>
      </dl>
    </blockquote>

    <p><a name="sect1i"></a>1i. <strong>Scripts</strong></p>

    <blockquote>
      <p>Script section should be placed at the end of the config file. All
      modules should be loaded and their variables should be set at this
      point.</p>

      <p><strong><em>source scripts/script.tcl</em></strong></p>

      <p>This line loads script.tcl in the scripts directory of your eggdrop.
      All script should be put there, although you can place them where you
      like as long as you can supply a fully qualified path to them.</p>

      <p>Some commonly loaded scripts are alltools.tcl and
      action.fix.tcl.</p>

      <p>The aproperiate source lines are:</p>

      <p><strong>source scripts/alltools.tcl<br>
       source scripts/action.fix.tcl</strong></p>
      <hr>

      <p><a name="sect2"></a>2. <strong>Output commands</strong></p>

      <blockquote>
        <dl>
          <dt><strong>putlog &lt;text&gt;</strong></dt>

          <dd>
            <p>sends text to the log for any channel, marked as
            &#39;misc&#39; (o);</p>

            <p>returns: nothing</p>
          </dd>

          <dt><strong>putcmdlog &lt;text&gt;</strong></dt>

          <dd>
            <p>sends text to the log for any channel, marked as
            &#39;command&#39; (c);</p>

            <p>returns: nothing</p>
          </dd>

          <dt><strong>putxferlog &lt;text&gt;</strong></dt>

          <dd>
            <p>sends text to the log for any channel, marked as
            &#39;file-area&#39; (x)</p>

            <p>returns: nothing</p>
          </dd>

          <dt><strong>putloglev &lt;level(s)&gt; &lt;channel&gt;
          &lt;text&gt;</strong></dt>

          <dd>
            <p>sends text to the log, tagged with all of the valid levels
            given (use &quot;*&quot; to indicate all log levels)</p>

            <p>returns: nothing</p>
          </dd>

          <dt><strong>dumpfile &lt;nick&gt; &lt;filename&gt;</strong></dt>

          <dd>
            <p>dumps out a file from the help/text directory to a user on IRC
            via msg (one line per msg); the user has no flags, so the flag
            bindings won&#39;t work within the file.</p>
          </dd>
        </dl>
      </blockquote>

      <p><a name="sect3"></a>3. <strong>User record manipulation
      commands</strong></p>

      <blockquote>
        <dl>
          <dt><strong>countusers</strong></dt>

          <dd>
            <p>returns: number of users in the bot&#39;s database</p>
          </dd>

          <dt><strong>validuser &lt;handle&gt;</strong></dt>

          <dd>
            <p>returns: &quot;1&quot; if a user by that name exists;
            &#39;0&#39; otherwise</p>
          </dd>

          <dt><strong>finduser &lt;nick!user@host&gt;</strong></dt>

          <dd>
            <p>finds the user record which most closely matches the given
            user@host</p>

            <p>returns: the handle found, or &quot;*&quot; if none</p>
          </dd>

          <dt><strong>userlist [flags]</strong></dt>

          <dd>
            <p>returns: a list of the handles of users on the bot. You can
            use the new flag matching system here.</p>

            <p>Example:</p>

            <p>[global]{&amp;/|}[chan]{&amp;/|}[bot]<br>
             matches the flags relevantly, (chan matches vs anywhere), &amp;
            specifies an and match, | specifies or, only the first of these
            is relevant, the default is or.</p>
          </dd>

          <dt><strong>passwdok &lt;handle&gt; &lt;pass&gt;</strong></dt>

          <dd>
            <p>checks the password given against the user&#39;s password --
            if the user has not set a password, will always return
            &quot;1&quot;; check against the password &quot;&quot; (a blank
            string) to find out if a user has no password set</p>

            <p>returns: &quot;1&quot; if password matches for that user;
            &quot;0&quot; if not</p>
          </dd>

          <dt><strong>getuser &lt;handle&gt; &lt;entry-type&gt; [extra
          info]</strong></dt>

          <dd>
            <p>This is a generic interface to the new generic userfile
            support, it return info specific to each entry-type.</p>

            <p>Valid entry types are:</p>

            <blockquote>
              <dl>
                <dt><strong>BOTFL</strong></dt>

                <dd>
                  <p>returns the current bot-specific flags for the user (if
                  it&#39;s a bot :)</p>
                </dd>

                <dt><strong>BOTADDR</strong></dt>

                <dd>
                  <p>(another bot-only thing :) returns a list containing the
                  bots address, the bots telnet port, and it&#39;s relay
                  port.</p>
                </dd>

                <dt><strong>HOSTS</strong></dt>

                <dd>
                  <p>returns a list of the host for the user</p>
                </dd>

                <dt><strong>LASTON</strong></dt>

                <dd>
                  <p>returns a list containing the unixtime last seen, and
                  the last seen place.</p>
                </dd>

                <dt><strong>LASTON #channel</strong></dt>

                <dd>
                  <p>returns the time last seen on the channel or 0 if no
                  info</p>
                </dd>

                <dt><strong>INFO</strong></dt>

                <dd>
                  <p>returns the user&#39;s global info line</p>
                </dd>

                <dt><strong>COMMENT</strong></dt>

                <dd>
                  <p>returns the master-visible only comment for the user</p>
                </dd>

                <dt><strong>EMAIL</strong></dt>

                <dd>
                  <p>returns the users email address</p>
                </dd>

                <dt><strong>URL</strong></dt>

                <dd>
                  <p>returns the users url address</p>
                </dd>

                <dt><strong>XTRA</strong></dt>

                <dd>
                  <p>returns xtra info, use the form:<br>
                   <strong>getuser &lt;handle&gt; XTRA
                  &lt;key&gt;</strong><br>
                   to receive data set for a certain key</p>
                </dd>
              </dl>
            </blockquote>
          </dd>

          <dt><strong>setuser &lt;handle&gt; &lt;entry-type&gt; [extra
          info]</strong></dt>

          <dd>
            <p>This is the counterpart of getuser, it lets you set the
            various values extra ones not supported about:</p>

            <blockquote>
              <dl>
                <dt><strong>PASS</strong></dt>

                <dd>
                  <p>use this to set a users password (no 3rd arg will clear
                  it)</p>
                </dd>

                <dt><strong>HOSTS</strong></dt>

                <dd>
                  <p>for setting hosts, no extra info = clear, otherwise
                  <strong>*1*</strong> hostmask is added</p>
                </dd>

                <dt><strong>LASTON</strong></dt>

                <dd>
                  <p>sets global laston time, will also set laston time for
                  any channel the user has a chanrec for (if it matches) to
                  prevent setting a channel time from <strong>ALSO</strong>
                  setting the global time use <strong>LASTON time #channel
                  *</strong></p>
                </dd>

                <dt><strong>XTRA</strong></dt>

                <dd>
                  <p>in the form:<br>
                   <strong>setuser &lt;handle&gt; XTRA &lt;key&gt;
                  &lt;data&gt;</strong><br>
                   sets up to 500 bytes of data per key (use no data to
                  clear)</p>
                </dd>
              </dl>
            </blockquote>
          </dd>

          <dt><strong>chnick &lt;old-handle&gt;
          &lt;new-handle&gt;</strong></dt>

          <dd>
            <p>changes a user&#39;s handle</p>

            <p>returns: &quot;1&quot; on success; &quot;0&quot; if the handle
            is already used, the handle is invalid, or the user can&#39;t be
            found</p>
          </dd>

          <dt><br>
           <strong>chattr &lt;handle&gt; [changes [channel]]</strong></dt>

          <dd>
            <p>changes the attributes for a user record, if you include any
            -- changes are of the form &quot;+f&quot;, &quot;-o&quot;,
            &quot;+dk&quot;, &quot;-o+d&quot;, etc; if a channel is
            specified, the channel-specific flags for that channel are
            altered you can now use the +o|-o #channel format here too.</p>

            <p>returns: new flags for the user (if you made no changes,
            returns current flags); if a channel was specified, the
            channel-specific flags for that channel are returned -- returns
            &quot;*&quot; if that user does not exist</p>
          </dd>

          <dt><strong>matchattr &lt;handle&gt; &lt;flags&gt;
          [channel]</strong></dt>

          <dd>
            <p>returns: &quot;1&quot; if the specified user has the matching
            flags. (using the new matching system)</p>
          </dd>

          <dt><strong>adduser &lt;handle&gt; &lt;hostmask&gt;</strong></dt>

          <dd>
            <p>creates a new user entry with the handle and hostmask given
            (with no password, and the default flags)</p>

            <p>returns: &quot;1&quot; if successful, &quot;0&quot; if it
            already existed</p>
          </dd>

          <dt><strong>deluser &lt;handle&gt;</strong></dt>

          <dd>
            <p>attempts to erase a user record with that handle</p>

            <p>returns: &quot;1&quot; if successful, &quot;0&quot; if no such
            user exists</p>
          </dd>

          <dt><strong>delhost &lt;handle&gt; &lt;hostmask&gt;</strong></dt>

          <dd>
            <p>deletes a hostmask from a user&#39;s hostmask list</p>

            <p>returns: &quot;1&quot; on success, &quot;0&quot; if that
            hostmask wasn&#39;t in the list or the user does not exist</p>
          </dd>

          <dt><strong>newignore &lt;hostmask&gt; &lt;creator&gt;
          &lt;comment&gt; [lifetime]</strong></dt>

          <dd>
            <p>adds an entry to the ignore list; creator is given credit for
            the ignore; lifetime is how many minutes until the ignore expires
            and is removed; if lifetime is not specified, ignore-time
            (usually 60) is used; setting the lifetime to 0 makes it a
            permanent ignore</p>

            <p>returns: nothing</p>
          </dd>

          <dt><strong>killignore &lt;hostmask&gt;</strong></dt>

          <dd>
            <p>removes an entry from the ignore list</p>

            <p>returns: &quot;1&quot; if successful, &quot;0&quot;
            otherwise</p>
          </dd>

          <dt><strong>ignorelist</strong></dt>

          <dd>
            <p>returns: list of ignores; each entry is itself a list,
            containing: hostmask, comment, expiration timestamp, time added,
            and creator (the three timestamps are in unixtime format)</p>
          </dd>

          <dt><strong>isignore &lt;hostmask&gt;</strong></dt>

          <dd>
            <p>returns: &quot;1&quot; if the ignore is in the list,
            &quot;0&quot; otherwise</p>
          </dd>

          <dt><strong>save</strong></dt>

          <dd>
            <p>writes the userfile to disk</p>

            <p>returns: nothing</p>
          </dd>

          <dt><strong>reload</strong></dt>

          <dd>
            <p>loads the userfile from disk (replacing whatever&#39;s in
            memory)</p>

            <p>returns: nothing</p>
          </dd>

          <dt><strong>backup</strong></dt>

          <dd>
            <p>makes a simple backup of the userfile that&#39;s on disk</p>

            <p>returns: nothing</p>
          </dd>

          <dt><strong>getting-users</strong></dt>

          <dd>
            <p>returns: &quot;1&quot; if the bot is currently downloading a
            userfile from a sharebot (and hence, user records are about to
            drastically change), &quot;0&quot; if not</p>
          </dd>
        </dl>
      </blockquote>
      <hr>

      <p><a name="sect4"></a>4. <strong>DCC commands</strong></p>

      <blockquote>
        <dl>
          <dt><strong>putdcc &lt;idx&gt; &lt;text&gt;</strong></dt>

          <dd>
            <p>sends text to the dcc user indicated</p>

            <p>returns: nothing</p>
          </dd>

          <dt><strong>dccbroadcast &lt;message&gt;</strong></dt>

          <dd>
            <p>sends your message to everyone on the party line on the bot
            net, in the form &quot;*** &lt;message&gt;&quot; for local users,
            and &quot;*** [Bot] &lt;message&gt;&quot; for users on other
            bots</p>
          </dd>

          <dt><strong>dccputchan &lt;channel&gt;
          &lt;message&gt;</strong></dt>

          <dd>
            <p>sends your message to everyone on a certain channel on the bot
            net, in a form exactly like dccbroadcast does -- valid channels
            are 0 thru 99999</p>

            <p>returns: nothing</p>
          </dd>

          <dt><strong>restart</strong></dt>

          <dd>
            <p>restarts the bot</p>

            <p>returns: nothing</p>
          </dd>

          <dt><strong>rehash</strong></dt>

          <dd>
            <p>rehashes the bot</p>

            <p>returns: nothing</p>
          </dd>

          <dt><strong>dccsimul &lt;idx&gt; &lt;text...&gt;</strong></dt>

          <dd>
            <p>simulates text typed in by the dcc user specified -- note that
            in v0.9, this only simulated commands; now a command must be
            preceded by a &#39;.&#39; to be simulated</p>

            <p>returns: nothing</p>
          </dd>

          <dt><strong>hand2idx &lt;handle&gt;</strong></dt>

          <dd>
            <p>returns: the idx (a number greater than or equal to zero) for
            the user given, if she is on the party line in chat mode (even if
            she is currently on a channel or in chat off), the file area, or
            in the control of a script; &quot;-1&quot; otherwise -- if the
            user is on multiple times, the oldest idx is returned</p>
          </dd>

          <dt><strong>idx2hand &lt;idx&gt;</strong></dt>

          <dd>
            <p>returns: handle of the user with that idx</p>
          </dd>

          <dt><strong>valididx &lt;idx&gt;</strong></dt>

          <dd>
            <p>returns: &quot;1&quot; if the idx currently exists;
            &quot;0&quot; if not</p>
          </dd>

          <dt><strong>botlist</strong></dt>

          <dd>
            <p>returns: a list of bots currently on the botnet; each item in
            the list will be a sublist with four elements: bot, uplink,
            version, sharing status.</p>

            <p>bot&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; : the bot&#39;s nickname<br>
             uptlink : who the bot is connected through<br>
             version : its currentnumeric version<br>
             sharing : a &quot;+&quot; if the bot is sharing, &quot;-&quot;
            otherwise</p>
          </dd>

          <dt><strong>islinked &lt;bot&gt;</strong></dt>

          <dd>
            <p>returns: &quot;1&quot; if thebot is currently linked,
            &quot;0&quot; otherwise</p>
          </dd>

          <dt><strong>getchan &lt;idx&gt;</strong></dt>

          <dd>
            <p>returns: the current party line channel for a user on the
            party line -- &quot;0&quot; indicates he&#39;s on the group party
            line, &quot;-1&quot; means he has chat off, and a value from 1 to
            99999 is a private channel</p>
          </dd>

          <dt><strong>setchan &lt;idx&gt; &lt;channel&gt;</strong></dt>

          <dd>
            <p>sets a party line user&#39;s channel rather suddenly (the
            party line user is not notified that she is now on a new
            channel); a channel name can be used (provided it exists.</p>

            <p>returns: nothing</p>
          </dd>

          <dt><strong>console &lt;idx&gt; [channel]
          [console-modes]</strong></dt>

          <dd>
            <p>changes a dcc user&#39;s consolemode, either to an absolute
            mode (like &quot;mpj&quot;) or just adding/removing flags (like
            &quot;+pj&quot; or &quot;-moc&quot; or &quot;+mp-c&quot;); the
            user&#39;s console channel view can be changed also (as long as
            the new channel is defined in the bot)</p>

            <p>returns: a list containing the user&#39;s (new) channel view,
            and (new) console mode, or nothing if that user isn&#39;t
            currently in dcc chat</p>
          </dd>

          <dt><strong>echo &lt;idx&gt; [status]</strong></dt>

          <dd>
            <p>turns a user&#39;s echo on or off; the status has to be a 1 or
            0</p>

            <p>returns: new value of echo for that user (or the current
            value, if status was omitted)</p>
          </dd>

          <dt><strong>killdcc &lt;idx&gt;</strong></dt>

          <dd>
            <p>kills a party-line or file area connection, rather
            abruptly</p>

            <p>returns: nothing</p>
          </dd>

          <dt><strong>dccused</strong></dt>

          <dd>
            <p>returns: number of dcc connections currently in use</p>
          </dd>

          <dt><strong>dcclist</strong></dt>

          <dd>
            <p>returns: list of active dcc connections that are in the chat
            area, the file area, or a script; each item in the list will be a
            sublist with four elements: idx, nickname, hostname, and type;
            type will be &quot;chat&quot;, &quot;files&quot;,
            &quot;bot&quot;, &quot;file_receiving&quot;,
            &quot;file_sending&quot;, &quot;file_send_pending&quot;, or
            &quot;script&quot; (or &quot;socket&quot; for connections that
            haven&#39;t been put under &#39;control&#39; yet) or any new dcc
            type that gets added.</p>
          </dd>

          <dt><strong>getdccidle &lt;idx&gt;</strong></dt>

          <dd>
            <p>returns: number of seconds the dcc chat/file system/script
            user has been idle</p>
          </dd>

          <dt><strong>getdccaway &lt;idx&gt;</strong></dt>

          <dd>
            <p>returns: away message for a dcc chat user (or &quot;&quot; if
            the user is not set away)</p>
          </dd>

          <dt><strong>setdccaway &lt;idx&gt; &lt;message&gt;</strong></dt>

          <dd>
            <p>sets a party line user&#39;s away message and marks them away;
            if set to &quot;&quot;, the user is marked un-away</p>

            <p>returns: nothing</p>
          </dd>

          <dt><strong>connect &lt;host&gt; &lt;port&gt;</strong></dt>

          <dd>
            <p>makes an outgoing connection attempt and creates a dcc entry
            for it; a &#39;control&#39; command should be used immediately
            after a successful &#39;connect&#39; so no input is lost</p>

            <p>returns: idx of the new connection</p>
          </dd>

          <dt><strong>listen &lt;port&gt; &lt;type&gt; [options]
          [flag]</strong></dt>

          <dd>
            <p>opens a listening port to accept incoming telnets; type must
            be one of &quot;bots&quot;, &quot;all&quot;, &quot;users&quot;,
            &quot;script&quot;, or &quot;off&quot;:</p>
          </dd>

          <dt><strong>listen &lt;port&gt; bots [mask]</strong></dt>

          <dd>
            <p>accepts connections from bots only; the optional mask is used
            to identify permitted bot names; if the mask begins with
            &#39;@&#39; it is interpreted to be a mask of permitted hosts to
            accept connections from</p>

            <p>returns: port #</p>
          </dd>

          <dt><strong>listen &lt;port&gt; users [mask]</strong></dt>

          <dd>
            <p>accepts connections from users only (no bots); the optional
            mask is used to identify permitted nicknames; if the mask begins
            with &#39;@&#39; it is interpreted to be a mask of permitted
            hosts to accept connections from</p>

            <p>returns: port #</p>
          </dd>

          <dt><strong>listen &lt;port&gt; all [mask]</strong></dt>

          <dd>
            <p>accepts connections from anyone; the optional mask is used to
            identify permitted nicknames/botnames; if the mask begins with
            &#39;@&#39; it is interpreted to be a mask of permitted hosts to
            accept connections from</p>

            <p>returns: port #</p>
          </dd>

          <dt><strong>listen &lt;port&gt; script &lt;proc&gt;
          [flag]</strong></dt>

          <dd>
            <p>accepts connections which are immediately routed to a proc;
            the proc is called with one parameter: the idx of the new
            connection flag may currently only be &#39;pub&#39;, which makes
            the bot allow anyone to connect.</p>

            <p>returns: port #</p>
          </dd>

          <dt><strong>listen &lt;port&gt; off</strong></dt>

          <dd>
            <p>stop listening at a port</p>

            <p>returns: nothing</p>
          </dd>

          <dt><strong>dccdumpfile &lt;idx&gt; &lt;filename&gt;</strong></dt>

          <dd>
            <p>dumps out a file from the text directory to a dcc chat user;
            the flag matching that&#39;s used everywhere else works here
            too</p>
          </dd>

          <dt><strong>link [via-bot] &lt;bot&gt;</strong></dt>

          <dd>
            <p>attempts to link to another bot directly (or, if you give a
            via-bot, it tells the via-bot to try</p>

            <p>returns: &quot;1&quot; if it looks okay and it will try;
            &quot;0&quot; if not</p>
          </dd>

          <dt><strong>unlink &lt;bot&gt;</strong></dt>

          <dd>
            <p>attempts to remove a bot from the botnet</p>

            <p>returns: &quot;1&quot; if it will try or has passed the
            request on; &quot;0&quot; if not</p>
          </dd>

          <dt><strong>encrypt &lt;key&gt; &lt;string&gt;</strong></dt>

          <dd>
            <p>returns: encrypted string (using blowfish), encoded into ascii
            using base-64 so it can be sent over the botnet</p>
          </dd>

          <dt><strong>decrypt &lt;key&gt;
          &lt;encrypted-base64-string&gt;</strong></dt>

          <dd>
            <p>returns: decrypted string (using blowfish)</p>
          </dd>

          <dt><strong>encpass &lt;password&gt;</strong></dt>

          <dd>
            <p>returns: encrypted string (using blowfish)</p>
          </dd>

          <dt><strong>md5 &lt;string&gt;</strong></dt>

          <dd>
            <p>returns: the 128 bits MD5 &quot;message-digest&quot; of the
            specified string.</p>
          </dd>
        </dl>
      </blockquote>

      <p><a name="sect5"></a>5. <strong>Miscellaneous commands</strong></p>

      <blockquote>
        <dl>
          <dt><strong>bind &lt;type&gt; &lt;attr(s)&gt; &lt;command-name&gt;
          [proc-name]</strong></dt>

          <dd>
            <p>adds a new keyword command to the bot; valid types are listed
            below; the &lt;attr(s)&gt; are the flags that a user must have to
            trigger this command; the &lt;command-name&gt; for each type is
            listed below; &lt;proc-name&gt; is the name of the Tcl procedure
            to call for this command (see below for the format of the
            procedure call); if the proc-name is omitted, no binding is added
            -- instead, the current binding is returned (if it&#39;s
            stackable, a list of the current bindings is returned) yes, you
            can use the new flag binding method here too, and this is where
            it becomes truely phearful since you may never need to check
            attr&#39;s inside functions again...imagine:</p>

            <p>bind pub -o&amp;+o command command_proc</p>

            <p>returns: name of the command that was added, or (if proc-name
            was omitted), a list of the current bindings for this command</p>
          </dd>

          <dt><strong>unbind &lt;type&gt; &lt;attr(s)&gt;
          &lt;command-name&gt; &lt;proc-name&gt;</strong></dt>

          <dd>
            <p>removes a previously-made binding</p>

            <p>returns: name of the command that was removed</p>
          </dd>

          <dt><strong>logfile [&lt;modes&gt; &lt;channel&gt;
          &lt;filename&gt;]</strong></dt>

          <dd>
            <p>creates a new logfile, which will log the modes given for the
            channel listed -- or, if no logfile is specified, just returns a
            list of logfiles; &quot;*&quot; can be used to mean all channels;
            you can also change the modes and channel of an existing logfile
            with this command -- entering a blank mode and channel makes the
            bot stop logging there</p>

            <p>returns: filename of logfile created, or (if no logfile is
            specified) a list of logfiles like: &quot;{mco * eggdrop.log} {jp
            #lame lame.log}&quot;</p>
          </dd>

          <dt><strong>maskhost &lt;nick!user@host&gt;</strong></dt>

          <dd>
            <p>returns: hostmask for the string given
            (&quot;n!u@1.2.3.4&quot; -&gt; &quot;*!u@1.2.3.*&quot;,
            &quot;n!u@lame.com&quot; -&gt; &quot;*!u@lame.com&quot;,
            &quot;n!u@a.b.edu&quot; -&gt; &quot;*!u@*.b.edu&quot;)</p>
          </dd>

          <dt><strong>unixtime</strong></dt>

          <dd>
            <p>returns: a long integer which is the current time according to
            unix</p>
          </dd>

          <dt><strong>strftime &lt;formatstring&gt; [time]</strong></dt>

          <dd>
            <p>returns: a formatted string of time using standard strftime
            format, uses the value of time, or now if no time specified</p>
          </dd>

          <dt><strong>ctime &lt;unixtime&gt;</strong></dt>

          <dd>
            <p>returns: a string of the date/time represented by the unix
            time given (i.e. &quot;Fri Aug 3 11:34:55 1973&quot;)</p>
          </dd>

          <dt><strong>myip</strong></dt>

          <dd>
            <p>returns: a long number representing the bot&#39;s IP address,
            as it might appear in (for example) a DCC request</p>
          </dd>

          <dt><strong>rand &lt;limit&gt;</strong></dt>

          <dd>
            <p>returns: a random integer between 0 and limit-1</p>
          </dd>

          <dt><strong>die [reason]</strong></dt>

          <dd>
            <p>causes the bot to log a fatal error and exit completely; if no
            reason is given, &quot;EXIT&quot; is used</p>
          </dd>

          <dt><strong>unames</strong></dt>

          <dd>
            <p>returns: the current operating system the bot is using.</p>
          </dd>
        </dl>
      </blockquote>
      <hr>

      <p><a name="sect6"></a>6. <strong>Global variables</strong></p>

      <blockquote>
        <p>(All config-file variables are global too, but these variables are
        set by the bot.)</p>
      </blockquote>

      <blockquote>
        <dl>
          <dt><strong>version</strong></dt>

          <dd>
            <p>current bot version (ie: &quot;1.1.2+pl1 1010201 pl1&quot;);
            first item is the text version, second item is a numerical
            version, and any following items are the names of patches that
            have been added</p>
          </dd>

          <dt><strong>numversion</strong></dt>

          <dd>
            <p>current numeric bot version (ie: &quot;1010201&quot;)</p>

            <p>Numerical version is &quot;MMNNRRPP&quot; where:</p>

            <p>MM is the major release number<br>
             NN is the minor release number<br>
             RR is the sub-release number<br>
             PP is the patch level for that sub-release</p>
          </dd>

          <dt><strong>uptime</strong></dt>

          <dd>
            <p>unixtime value for when the bot was started</p>
          </dd>

          <dt><strong>lastbind</strong></dt>

          <dd>
            <p>The last command binding which triggered. This allows you to
            identify which command triggered a tcl routine.</p>
          </dd>
        </dl>
      </blockquote>
      <hr>

      <p><a name="sect7"></a>7. <strong>Command extension</strong></p>

      <blockquote>
        <p>You can use the &#39;bind&#39; command to attach Tcl procedures to
        certain events. For example, you can write a Tcl procedure that gets
        called every time a user says &quot;danger&quot; on the channel. The
        following is a list of the types of bindings, and how they work.
        Under each binding type is the format of the bind command, the list
        of arguments sent to the Tcl proc, and an explanation.</p>

        <p>Some bindings are marked as &quot;stackable&quot;. That means that
        you can bind multiple commands to the same trigger. Normally, for
        example, a binding of &quot;bind msg - stop msg_stop&quot; (which
        makes a msg-command &quot;stop&quot; call the Tcl proc
        &quot;msg_stop&quot;) will overwrite any previous binding you had for
        the msg-command &quot;stop&quot;. With stackable bindings, like
        &#39;msgm&#39; for example, you can bind to the same command or mask
        again and again. When the binding is triggered, ALL the Tcl procs
        that are bound to it will be called, one after another.</p>

        <p>To remove a binding, use &quot;unbind&quot;. For example, to
        remove that binding for the msg-command &quot;stop&quot;, use
        &quot;unbind msg - stop msg_stop&quot;.</p>

        <p>There are more bindings which are enabled from the loading of
        specific modules, see the specific module information pages to see
        which module provides which bindings.</p>
      </blockquote>

      <blockquote>
        <dl>
          <dt><strong>DCC</strong></dt>

          <dd>
            <p>bind dcc &lt;flags&gt; &lt;command&gt; &lt;proc&gt;<br>
             proc-name &lt;handle&gt; &lt;idx&gt; &lt;args&gt;</p>

            <p>used for commands from a dcc chat on the party line; as in
            MSG, the command is the first word and everything else is the
            argument string; the idx is valid until the user disconnects;
            after that it may be reused, so be careful about storing an idx
            for long periods of time</p>
          </dd>

          <dt><strong>BOT</strong></dt>

          <dd>
            <p>bind bot &lt;flags&gt; &lt;command&gt; &lt;proc&gt;<br>
             proc-name &lt;from-bot&gt; &lt;command&gt; &lt;args&gt;</p>

            <p>triggered by a message coming from another bot in the botnet;
            works similar to a DCC binding; the first word is the command and
            the rest becomes the argument string; flags are ignored</p>
          </dd>

          <dt><strong>CHON (stackable)</strong></dt>

          <dd>
            <p>bind chon &lt;flags&gt; &lt;mask&gt; &lt;proc&gt;<br>
             proc-name &lt;handle&gt; &lt;idx&gt;</p>

            <p>when someone first enters the &quot;party-line&quot; area of
            the bot via dcc chat or telnet, this is triggered before they are
            connected to a chat channel (so yes, you can change the channel
            in a &#39;chon&#39; proc); mask matches against handle; this is
            NOT triggered when someone returns from the file area, etc</p>
          </dd>

          <dt><strong>CHOF (stackable)</strong></dt>

          <dd>
            <p>bind chof &lt;flags&gt; &lt;mask&gt; &lt;proc&gt;<br>
             proc-name &lt;handle&gt; &lt;idx&gt;</p>

            <p>triggered when someone leaves the party line to disconnect
            from the bot; mask matches against the handle; note that the
            connection may have already been dropped by the user, so
            don&#39;t send output to that idx</p>
          </dd>

          <dt><strong>CHAT (stackable)</strong></dt>

          <dd>
            <p>bind chat &lt;flags&gt; &lt;mask&gt; &lt;proc&gt;<br>
             proc-name &lt;nick&gt; &lt;channel#&gt; &lt;text&gt;</p>

            <p>when someone says something on the botnet, it invokes this
            binding; flags is ignored; nick could be a user on this bot (i.e.
            &quot;DronePup&quot;) or on another bot (i.e.
            &quot;Eden@Wilde&quot;); the mask is checked against the text</p>
          </dd>

          <dt><strong>LINK (stackable)</strong></dt>

          <dd>
            <p>bind link &lt;flags&gt; &lt;mask&gt; &lt;proc&gt;<br>
             proc-name &lt;botname&gt; &lt;via&gt;</p>

            <p>triggered when a bot links into the botnet; botname is the
            name of the bot that just linked in; via is the bot it linked
            through; the mask is checked against the bot that linked; flags
            is ignored</p>
          </dd>

          <dt><strong>DISC (stackable)</strong></dt>

          <dd>
            <p>bind disc &lt;flags&gt; &lt;mask&gt; &lt;proc&gt;<br>
             proc-name &lt;botname&gt;</p>

            <p>triggered when a bot disconnects from the botnet for whatever
            reason; just like the link bind, flags are ignored; mask is
            checked against the nickname of the bot that left</p>
          </dd>

          <dt><strong>FILT (stackable)</strong></dt>

          <dd>
            <p>bind filt &lt;flags&gt; &lt;mask&gt; &lt;proc&gt;<br>
             proc-name &lt;idx&gt; &lt;text&gt;</p>

            <p>DCC party line and file system users have their text sent
            through filt before being processed; if the proc a blank string,
            the text is considered parsed; otherwise the bot will use the
            text returned from the proc and continue parsing that</p>
          </dd>

          <dt><strong>ACT (stackable)</strong></dt>

          <dd>
            <p>bind act &lt;flags&gt; &lt;mask&gt; &lt;proc&gt;<br>
             proc-name &lt;nick&gt; &lt;channel#&gt; &lt;action&gt;</p>

            <p>when someone does an action on the botnet, it invokes this
            binding; flags is ignored; the mask is checked against the text
            of the action (this is very similar to the CHAT binding)</p>
          </dd>

          <dt><strong>BCST (stackable)</strong></dt>

          <dd>
            <p>bind chat &lt;flags&gt; &lt;mask&gt; &lt;proc&gt;<br>
             proc-name &lt;bot&gt; &lt;channel#&gt; &lt;text&gt;</p>

            <p>when a bot says something on the botnet, it invokes this
            binding; flags is ignored; the mask is checked against the
            text</p>
          </dd>

          <dt><strong>CHJN (stackable)</strong></dt>

          <dd>
            <p>bind chat &lt;flags&gt; &lt;mask&gt; &lt;proc&gt;<br>
             proc-name &lt;bot&gt; &lt;nick&gt; &lt;channel#&gt;
            &lt;flag&gt;&lt;sock&gt; &lt;from&gt;</p>

            <p>when someone joins a botnet channel, it invokes this binding;
            flags is ignored; the mask is checked against the text</p>
          </dd>

          <dt><strong>CHPT (stackable)</strong></dt>

          <dd>
            <p>bind chat &lt;flags&gt; &lt;mask&gt; &lt;proc&gt;<br>
             proc-name &lt;bot&gt; &lt;nick&gt; &lt;sock&gt; &lt;chan&gt;</p>

            <p>when someone parts a botnet channel, it invokes this binding;
            flags is ignored; the mask is checked against the channel</p>
          </dd>

          <dt><strong>TIME (stackable)</strong></dt>

          <dd>
            <p>bind time - &lt;mask&gt; &lt;proc&gt;<br>
             proc-name &lt;min&gt; &lt;hour&gt; &lt;day&gt; &lt;month&gt;
            &lt;year&gt;</p>

            <p>allows you to schedule procedure calls at certain times, mask
            matches 5 space seperated integers of the form: &quot;min hour
            day month year&quot;</p>
          </dd>

          <dt><strong>AWAY (stackable)</strong></dt>

          <dd>
            <p>bind away - &lt;mask&gt; &lt;proc&gt;<br>
             proc-name &lt;bot&gt; &lt;idx&gt; &lt;msg&gt;</p>

            <p>triggers when a user goes away or comes back on the botnet
            (msg == &quot;&quot; when returning)</p>
          </dd>

          <dt><strong>LOAD (stackable)</strong></dt>

          <dd>
            <p>bind load - &lt;mask&gt; &lt;proc&gt;<br>
             proc-name &lt;module&gt;</p>

            <p>triggers when a module is loaded.</p>
          </dd>

          <dt><strong>UNLD (stackable)</strong></dt>

          <dd>
            <p>bind unld - &lt;mask&gt; &lt;proc&gt;<br>
             proc-name &lt;module&gt;</p>

            <p>triggers when a module is unloaded.</p>
          </dd>

          <dt><strong>NKCH (stackable)</strong></dt>

          <dd>
            <p>bind nkch - &lt;mask&gt; &lt;proc&gt;<br>
             proc-name &lt;oldnick&gt; &lt;newnick&gt;</p>

            <p>triggered whenever a local users nick is changed (in the
            userfile)</p>
          </dd>

          <dt><strong>EVNT&nbsp;&nbsp; (stackable)</strong></dt>

          <dd>
            <p>bind evnt - &lt;type&gt; &lt;proc&gt;<br>
             proc-name &lt;type&gt;</p>

            <p>triggered whenever one of these events happens. valid events
            are:</p>

            <blockquote>
              <dl>
                <dt><strong>sighup</strong></dt>

                <dd>
                  <p>called on a kill -HUP &lt;pid&gt;</p>
                </dd>

                <dt><strong>sigterm</strong></dt>

                <dd>
                  <p>called on a kill -TERM &lt;pid&gt;</p>
                </dd>

                <dt><strong>sigill</strong></dt>

                <dd>
                  <p>called on a kill -ILL &lt;pid&gt;</p>
                </dd>

                <dt><strong>sigquit</strong></dt>

                <dd>
                  <p>called on a kill -QUIT &lt;pid&gt;</p>
                </dd>

                <dt><strong>save</strong></dt>

                <dd>
                  <p>called when the userfile is saved</p>
                </dd>

                <dt><strong>rehash</strong></dt>

                <dd>
                  <p>called just after a rehash</p>
                </dd>

                <dt><strong>prerehash</strong></dt>

                <dd>
                  <p>called just before a rehash</p>
                </dd>

                <dt><strong>logfile</strong></dt>

                <dd>
                  <p>called when the logs are switched daily</p>
                </dd>
              </dl>
            </blockquote>
          </dd>
        </dl>
      </blockquote>
      <hr>

      <p><a name="sect8"></a>8. <strong>Return values</strong></p>

      <blockquote>
        <p>Several bindings pay attention to the value you return from the
        proc (using &quot;return $value&quot;). Usually they expect a 0 or 1,
        and failing to return any value is interpreted as a 0.</p>

        <p>Here&#39;s a list of the bindings that use the return value from
        procs they trigger, these bindings are mostly enabled from the
        loading of specific modules, see the specific module information
        pages to see which module provides which bindings.</p>
      </blockquote>

      <blockquote>
        <dl>
          <dt><strong>MSG</strong></dt>

          <dd>
            <p>Return 1 to make the command get logged like so:<br>
             (nick!user@host) !handle! command</p>
          </dd>

          <dt><strong>DCC</strong></dt>

          <dd>
            <p>Return 1 to make the command get logged like so:<br>
             #handle# command</p>
          </dd>

          <dt><strong>FIL</strong></dt>

          <dd>
            <p>Return 1 to make the command get logged like so:<br>
             #handle# files: command</p>
          </dd>

          <dt><strong>PUB</strong></dt>

          <dd>
            <p>Return 1 to make the command get logged like so:<br>
             &lt;&lt;nick&gt;&gt; !handle! command</p>
          </dd>

          <dt><strong>CTCP</strong></dt>

          <dd>
            <p>Return 1 to ask the bot not to process the CTCP command on its
            own. Otherwise it would send its own response to the CTCP
            (possibly an error message if it doesn&#39;t know how to deal
            with it).</p>
          </dd>

          <dt><strong>FILT</strong></dt>

          <dd>
            <p>Return 1 to indicate the text has been processed, and the bot
            should just ignore it. Otherwise it will treat the text like any
            other.</p>
          </dd>

          <dt><strong>FLUD</strong></dt>

          <dd>
            <p>Return 1 to ask the bot not to take action on the flood.
            Otherwise it will do its normal punishment.</p>
          </dd>

          <dt><strong>RAW</strong></dt>

          <dd>
            <p>Return 1 to ask the bot not to process the server text. This
            can affect the bot&#39;s performance (by causing it to miss
            things that it would normally act on) -- you have been
            warned.</p>
          </dd>

          <dt><strong>WALL</strong></dt>

          <dd>
            <p>Return 1 to make the command get logged liked so:<br>
             !nick! msg</p>
          </dd>
        </dl>
      </blockquote>
      <hr>

      <p><a name="sect9"></a>9. <strong>Matching characters</strong></p>

      <blockquote>
        <p>Many of the bindings allow match characters in the arguments. Here
        are the four special characters:</p>

        <p>? matches any single character<br>
         * matches 0 or more characters of any type<br>
         % matches 0 or more non-space characters (can be used to match a
        single word)<br>
         ~ matches 1 or more space characters (can be used for whitespace
        between words)</p>
      </blockquote>
      <hr>
    </blockquote>

    <p><em> 1997 Robey Pointer<br>
      1999,2000 <a href="http://www.eggheads.org/">Eggheads</a></em></p>
  </body>
</html>
