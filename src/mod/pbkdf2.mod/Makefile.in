# Makefile for src/mod/pbkdf2.mod/

srcdir = .

CRYPTODEP=@CRYPTODEP@

MYCPPFLAGS=@CPPFLAGS@ $(CPPFLAGS)
MYCFLAGS=$(CFLAGS) $(MYCPPFLAGS)
LIBS=@LIBS@
LDFLAGS=@LDFLAGS@

MAKE_DEPEND = $(MAKE) 'MAKE=$(MAKE)' 'CC=$(CC)' \
		 'CFLAGS=-I.. -I../../../.. -DMAKING_DEPEND -DHAVE_CONFIG_H -DMAKING_MODS'

MAKE_GENERIC = $(MAKE) 'MAKE=$(MAKE)' 'CC=$(CC)' 'LD=$(LD)' \
               'CFLAGS=-I.. -I../../../.. $(CFLAGS_NOINC)' \
               'LDFLAGS=$(LDFLAGS)'

doofus:
	@echo ""
	@echo "Let's try this from the right directory..."
	@echo ""
	@cd ../../../ && make

static: ../pbkdf2.o

modules: $(CRYPTODEP) ../../../pbkdf2.$(MOD_EXT)

mbedtls.o:
	@(cd mbedtls && $(MAKE_GENERIC) "VPATH=." "srcdir=." mbedtls)

../pbkdf2.o: pbkdf2.c
	$(CC) $(MYCFLAGS) -DMAKING_MODS -c $(srcdir)/pbkdf2.c
	@rm -f ../pbkdf2.o
	mv pbkdf2.o ../

../../../pbkdf2.$(MOD_EXT): ../pbkdf2.o
	$(LD) $(LDFLAGS) -o ../../../pbkdf2.$(MOD_EXT) ../pbkdf2.o $(CRYPTODEP) $(LIBS) $(XLIBS) $(MODULE_XLIBS)
	$(STRIP) ../../../pbkdf2.$(MOD_EXT)

depend:
	$(CC) $(CFLAGS) -MM $(srcdir)/*.c > .depend
	@(cd mbedtls && $(MAKE_DEPEND) "VPATH=." "srcdir=." depend)

clean:
	@rm -f .depend *.o *.$(MOD_EXT) *~
	@(cd mbedtls && $(MAKE) "VPATH=." "srcdir=." clean)

distclean: clean
	@rm -rf autom4te.cache Makefile config.log config.status config.cache

#safety hash
pbkdf2.o: .././pbkdf2.mod/pbkdf2.c ../../../src/mod/module.h \
 ../../../src/main.h ../../../config.h ../../../eggint.h ../../../lush.h \
 ../../../src/lang.h ../../../src/eggdrop.h ../../../src/compat/in6.h \
 ../../../src/flags.h ../../../src/cmdt.h ../../../src/tclegg.h \
 ../../../src/tclhash.h ../../../src/chan.h ../../../src/users.h \
 ../../../src/compat/compat.h ../../../src/compat/inet_aton.h \
 ../../../src/compat/snprintf.h ../../../src/compat/memset.h \
 ../../../src/compat/memcpy.h ../../../src/compat/strcasecmp.h \
 ../../../src/compat/strftime.h ../../../src/compat/inet_ntop.h \
 ../../../src/compat/inet_pton.h ../../../src/compat/gethostbyname2.h \
 ../../../src/mod/modvals.h ../../../src/tandem.h
